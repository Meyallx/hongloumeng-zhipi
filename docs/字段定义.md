# 数据字段完整定义

## 1. 文本数据（chapter_XXX.jsonl）

每行代表一个句子。

### 必填字段

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| id | string | 句子唯一ID | `"v001_ch001_s001"` |
| versionId | string | 版本ID | `"version_001"` |
| chapterId | string | 章节ID | `"ch001"` |
| chapterNumber | number | 章节号 | `1` |
| chapterTitle | string | 章节标题 | `"甄士隐梦幻识通灵..."` |
| sentenceIndex | number | 句子序号 | `1` |
| paragraphIndex | number | 段落序号 | `1` |
| text | string | 句子文本 | `"此开卷第一回也。"` |
| punctuation | string | 句尾标点 | `"。"` |

### 可选字段

| 字段 | 类型 | 说明 |
|------|------|------|
| metadata.hasVariant | boolean | 是否有异文 |
| metadata.hasAnnotation | boolean | 是否有批注 |
| metadata.wordCount | number | 字数 |

---

## 2. 批注数据（annotations/zhipan.jsonl）

每行代表一条批注。

### 必填字段

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| id | string | 批注ID | `"zp_001"` |
| type | string | 批注类型 | `"zhipan"` |
| subType | string | 子类型 | `"jiapan"` / `"meipan"` |
| source | string | 来源 | `"甲戌本"` |
| targetVersion | string | 目标版本 | `"version_001"` |
| targetChapter | string | 目标章节 | `"ch001"` |
| content.raw | string | 原始批注 | `"【甲戌眉批】..."` |
| content.text | string | 纯文本 | `"此是第一首..."` |
| content.marker | string | 批注标记 | `"甲戌眉批"` |

### 位置字段（夹批）

| 字段 | 类型 | 说明 |
|------|------|------|
| position.type | string | `"inline"` |
| position.charStart | number | 起始位置 |
| position.charEnd | number | 结束位置 |

### 位置字段（眉批）

| 字段 | 类型 | 说明 |
|------|------|------|
| position.type | string | `"margin"` |
| position.location | string | `"pageTop"` / `"pageBottom"` |

---

## 3. 异文数据（variants/variants.jsonl）

每行代表一条异文记录。

### 必填字段

| 字段 | 类型 | 说明 |
|------|------|------|
| id | string | 异文ID |
| baseSentenceId | string | 基准句子ID |
| variants[] | array | 各版本文字 |
| variants[].versionId | string | 版本ID |
| variants[].text | string | 该版本文字 |
| position.charStart | number | 起始位置 |
| position.charEnd | number | 结束位置 |

### 分析字段

| 字段 | 类型 | 说明 |
|------|------|------|
| analysis.type | string | 异文类型 |
| analysis.description | string | 分析说明 |
| analysis.significance | string | 重要性 |

**异文类型（analysis.type）：**
- `synonym`: 同义替换
- `addition`: 增加
- `deletion`: 删除
- `rephrasing`: 改写
- `wordOrder`: 语序调整

---

## 4. 字典数据

### words.jsonl（词语）

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | ✅ | 词条ID |
| term | string | ✅ | 词语 |
| type | string | ✅ | `"词语"` |
| pinyin | string | ✅ | 拼音 |
| definition | string | ✅ | 简短定义 |
| explanation | string | ✅ | 详细解释 |
| examples[] | array | ✅ | 例句 |

### allusions.jsonl（典故）

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | ✅ | 典故ID |
| term | string | ✅ | 典故名 |
| type | string | ✅ | `"典故"` |
| historicalContext | string | ❌ | 历史背景 |
| culturalNote | string | ❌ | 文化注释 |

### culture.jsonl（文化背景）

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | ✅ | 背景ID |
| term | string | ✅ | 主题 |
| type | string | ✅ | `"文化背景"` |
| details | object | ❌ | 详细内容（结构灵活） |

---

## ID命名规范
句子ID： v{版本号}_ch{章节号}_s{句子号}
v001_ch001_s001

批注ID： zp_{序号}
zp_001

异文ID： var_{序号}
var_001

词条ID： dict_w_{序号} (词语)
dict_a_{序号} (典故)
dict_c_{序号} (文化背景)


*.txt
Plaintext

---

## 日期格式

统一使用ISO 8601格式：
完整时间：2024-01-20T10:00:00Z
仅日期： 2024-01-20
